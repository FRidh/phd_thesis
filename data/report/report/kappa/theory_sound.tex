\section{Sound}

A repetitive variation about a central value of some quantity is called an
oscillation. Oscillations of mechanical nature are vibrations. An
oscillation travelling through a medium and transferring energy is a wave. Sound
is then a mechanical wave travelling through a fluid medium. Furthermore, only
those oscillations that can be perceived by the human brain are typically
considered sound.
Being a small repetitive perturbation about the barometric
mean pressure of the medium, the fluctuating or dynamic part of the pressure,
denoted sound pressure, is typically many orders smaller than the mean
pressure.

In the \nth{17} century Newton proposed a model for sound waves in elastic media
in his Principia. Already aware that the humidity of the air influences the
speed of sound, Newton assumed an isothermal process for the wave motion and
thereby computed incorrect values for the speed of sound. Laplace gave the
correct derivation of the classical wave equation, describing the wave motion as
a adiabatic process. In the \nth{19} century Kirchoff described the motion of a
rigid body in an ideal fluid and Helmholtz gave a time-independent form of the
wave equation. These were some of the important foundations for the classical
theory of sound.
% A limitation of the developed theory was the lack of sound generation models. In
% the classical theory sound was only generated through a vibrating solid
% boundary. In the 1950s
In this section a brief overview is given of sound.



\subsection{Wave equation}\label{sec:theory:sound:wave}
% In his Principia, Newton gave an description of sound and a value of the speed of sound.
The wave equation is a differential equation for describing waves and is used
throughout physics. In the \nth{18} century d'Alembert discovered the
one-dimensional wave equation, and a couple of years later Euler presented the
three-dimensional wave equation. The acoustic wave equation describes the motion
of sound waves and can be derived from the fundamental laws of fluid dynamics \cite{Arntzen2014a, Rienstra2017}.

\subsubsection*{Mass and momentum conservation}
The mass conservation or continuity equation is given by
% Mass conservation equation
\begin{equation}\label{eq:theory:sound:wave:mass}
 \frac{\partial \rho}{\partial t} + \nabla \cdot \rho \vect{u} = m
\end{equation}
with $\rho$ the density of the medium, $t$ the time, $\vect{u}$ the flow velocity
vector, $m$ the mass and $\nabla = \left( \frac{\partial}{\partial
x_1},\frac{\partial}{\partial x_2},\frac{\partial}{\partial x_3} \right)$.
The momentum conservation equation is
% Momentum conservation equation
\begin{equation}\label{eq:theory:sound:wave:momentum}
 \frac{\partial}{\partial t} \rho \vect{u} + \nabla \cdot \left(\matr{P} + \rho \vect{u} \vect{u}  \right) = \vect{f} + m \vect{u}
\end{equation}
where $\vect{u} \vect{u}$ is a dyadic product, $\vect{f}$ the external force
density and $\matr{P}$ the fluid stress tensor. The fluid stress tensor relates the pressure $p$ and the viscous stress tensor $\matr{\tau}$ by
% Viscous stress tensor
\begin{equation}
  \matr{P} = p \matr{I} - \matr{\tau}
\end{equation}
where $\matr{I}$ is a unit tensor. Viscous stresses are small compared to inertial
forces. Ignoring them, and rewriting equation
\ref{eq:theory:sound:wave:momentum} using equation
\ref{eq:theory:sound:wave:mass}, we obtain the following form for the momentum conservation equation
\begin{equation}
 \rho \left( \frac{\partial \vect{u}}{\partial t} + \left( \vect{u} \cdot \nabla \right) \vect{u} \right) + \nabla p = \vect{f}
\end{equation}
\subsubsection*{Linearisation}
Sound is a small perturbation of a steady state, and so we can apply linearisation to obtain a wave equation.
Ignoring the source term at the right-hand side, the linearised versions of the mass and momentum equations are given by
% Linearised versions of the homogeneous (= without source terms) mass and momentum equations
\begin{align}
 \frac{\partial \rho'}{\partial t} + \vect{u_0} \cdot \nabla \rho' + \rho_0 \nabla \cdot \vect{u'} = 0 \\
% \end{equation}
% \begin{equation}
 \rho_0 \left( \frac{\partial \vect{u'}}{\partial t} + \left(\vect{u_0} \cdot \nabla \right) \vect{u'}\right) + \nabla p' = 0
\end{align}
with the fluctuating components of the variables denoted with a prime. Viscosity
is neglected and thereby also heat transfer. The fluid is considered to behave
adiabatic and thus the following relation between pressure and density
fluctuations can be used
% Adiabatic relation between pressure and density fluctuations
\begin{equation}
  p' = c^2 \rho'
\end{equation}
where $c$ is the speed of sound
% Speed of sound for adiabatic process
\begin{equation}
  c = \sqrt{ \left( \frac{\partial p}{\partial \rho} \right)_{s} }
\end{equation}
The subscript $s$ indicates a process at constant entropy $s$ or adiabatic process.
In general, the speed of sound is given by $c = \sqrt{\frac{K}{\rho}}$ where $K$
is the bulk modulus of the medium. For ideal gases the bulk modulus is $K=\gamma
p$ where $\gamma=C_p/C_v$ is the ratio of specific heat capacity at constant
pressure $C_p$ and volume $C_V$.

\todo{combine into wave equation}
...
Classical wave equation
\begin{equation}\label{eq:theory:sound:wave:classic}
 \frac{1}{c} \frac{\partial^2 p'}{\partial t^2} - \nabla^2 p' = 0
\end{equation}
...


\subsubsection*{Helmholtz equation}

\begin{equation}
  p' (t, \vect{x}) = \hat{p} \left(\vect{x}\right) \exp{j \omega t}
\end{equation}


\begin{equation}\label{eq:theory:sound:wave:helmholtz}
 \nabla^2 \hat{p} + k^2 \hat{p} = 0
\end{equation}


\subsection{Convective wave equation}
A mean flow has an effect on sound generation and propagation.
The material derivative $D/Dt$ is defined as
\begin{equation}
  \frac{D}{Dt} = \frac{\partial}{\partial t} + \vect{u} \nabla
\end{equation}
and is a time derivative of some physical quantity for a portion of a material moving with a velocity $\vect{u}$.





\subsubsection*{Green's function}\label{sec:theory:sound:green}
% Homogeneous
% \begin{equation}
%
% \end{equation}
Non-homogeneous
\begin{equation}
\frac{1}{c^2}\frac{\partial^2 G}{\partial t^2} - \nabla^2 G = \delta \left( \vect{x} - \vect{y} \right) \delta \left(t - \tau \right)
\end{equation}

Free-field solution
\begin{equation}
 G = \frac{1}{4 \pi r} \delta \left( t - \tau - \frac{r}{c} \right)
\end{equation}

with $r = \left| \vect{x} - \vect{y} \right|$


\subsection{Aerodynamic sound sources}\label{sec:theory:sound:aerodynamic}
The classic wave equation cannot describe aerodynamic sources. Lighthill
provided the theory to take into account aerodynamic sources. The aero-acoustic
analogy of Lighthill is the idea of representing a fluid mechanical process that
acts as an acoustic source by an acoustically equivalent source term.

% He drew an analogy between the non-homogeneous versions of the fluid equations and the classical
% wave equation including the single acoustic source term.

Taking the time derivative of the homogeneous version of the mass conservation
equation (eq. \ref{eq:theory:sound:wave:mass}) and the divergence of the
homogeneous version of the momentum conservation equation (eq.
\ref{eq:theory:sound:wave:momentum}), then subtracting one from another, and
finally subtracting from both sides of the equation $c^2 \nabla^2 \rho$, results in the Lighthill
equation
\begin{equation}
  \frac{\partial^2 \rho}{\partial t^2} - c^2 \nabla^2 \rho = \nabla^2 \matr{T}
\end{equation}
where $\matr{T}$ is the Lighthill stress tensor
\begin{equation}
  \matr{T} = \rho \vect{u}\vect{u} + \left( \left( p - c^2 \rho \right) \matr{I} - \matr{\tau}  \right)
\end{equation}

Lighthill's acoustic analogy has the limitation that the source field is not
coupled to the acoustic field. That means situations where feedback occurs,
i.e., the acoustic field modifies the flow field and vice versa, cannot be
treated.

\subsection{Elementary sources}

The elementary sources 

\missingfigure{Figure of monopole, dipole and quadrupole}

\subsubsection*{Monopole}

Volume source
%
% \begin{equation}
%  \frac{d^2 \rho'}{dt^2}
% \end{equation}

\begin{equation}
 p' \left(\vect{x},t\right) = \frac{1}{4\pi} \frac{q \left(\vect{y}, t-r/c\right)}{r}
\end{equation}

\subsubsection*{Dipole}

\begin{equation}
 p' \left(\vect{x}, t\right) =
\end{equation}


\subsubsection*{Quadrupole}

Moment

\subsubsection*{Multipoles and spherical harmonics}\todo{Unless I would write a piece about Ambisonics I have no need for this so could skip it}


\missingfigure{Multipoles and spherical harmonics}

Ambisonics


\subsection{Moving source}

\subsubsection{Convective amplification}

\missingfigure{Convective amplification illustration}

\subsubsection{Doppler shift}

\missingfigure{Doppler shift illustration}



% \chapter{Sound propagation}


\subsection{Atmospheric attenuation}\label{sec:theory_sound_atmospheric_attenuation}
Soundwaves are attenuated due to relaxation processes in the medium.
A model for atmospheric attenuation is given in Part 1 of ISO 9613-1:1993\cite{ISO9613-1}.
The attenuation coefficient $\alpha$, in dB/m, is given by
\begin{align}\label{eq:theory:sound:atmospheric-attenuation}
 \alpha &= 8.686 f^2 \Biggl( \left[ 1.84 \times 10^{-11} \left(\frac{p_r}{p_a}\right)^{-1} \left(\frac{T}{T_0}\right)^{1/2} \right] + \left(\frac{T}{T_0}\right)^{-5/2} \nonumber \\ 
 &\times \Biggl\{ 0.01275 \left[ \exp{\frac{-2239.1}{T}} \right]  \left[f_{r,O} + \frac{f^2}{f_{r,O}} \right]^{-1} \nonumber \\
 &+ 0.1068 \left[ \exp{\frac{-3352.0}{T}} \right] \left[ f_{r,N} + \frac{f^2}{f_{r,N}} \right]^{-1} \Biggr\} \Biggr) 
\end{align}
and is a function of the ambient temperature in kelvin $T$, the reference
temperature $T_0=293.15$ K, the ambient pressure $p_a$ in kilopascal, the
reference pressure $p_r=101.325$ kPa and the relaxation frequencies for oxygen 
$f_{r,O}$ and nitrogen $f_{r,N}$.
The relaxation frequency of oxygen is given by
\begin{equation}
 f_{r,O} = \frac{p_a}{p_r} \left( 24 + 4.04 \cdot 10^4 h \frac{0.02 + h}{0.391 + h}  \right)
\end{equation}
and the relaxation frequency of nitrogen by
\begin{equation}
 f_{r,N} = \frac{p_a}{p_r} \left( \frac{T}{T_0} \right)^{-1/2} \cdot \left( 9 + 280 h \exp{\left\{ -4.170 \left[ \left(\frac{T}{T_0} \right)^{-1/3} -1 \right] \right\} } \right)
\end{equation}
Both depend on the molar concentration of water vapour $h$, given by
\begin{equation}
 h = h_r  \frac{p_{sat}}{p_a}
\end{equation}
The molar concentration of water vapour is a function of the saturation pressure
\begin{equation}
 p_{sat} = 10^C \cdot p_r
\end{equation}
where 
\begin{equation}
 C = -6.8346 \cdot \left( \frac{T_{01}}{T} \right)^{1.261}  + 4.6151
\end{equation}
In this equation $T_{01}$ is the triple-point isotherm temperature of 273.16 K.

The standard furthermore mentions the following expression for the speed of sound
\begin{equation}
c = 343.2 \left( \frac{T}{T_0} \right)
\end{equation}

\begin{figure}[H]
        \centering
        \includegraphics[]{../figures/generated/sound/attenuation}
        \caption{Atmospheric attenuation as function of frequency for a standard atmosphere.}
        \label{fig:theory:sound:attenuation}
\end{figure}

\newpage
\subsection{Reflections}
Sound hitting a boundary between materials of different impedance may be
transmitted, reflected or absorbed. When sound is transmitted the incident wave
is partially refracted. Sound reflected by a smooth surface results in a
specular reflection, and sound reflected on a rough surface results in a diffuse
reflection. In outdoor situations sound is typically reflected by the ground surface and other
obstacles like buildings. The sound pressure at a receiver is then the sum of
the direct contribution as well as indirect contributions from reflections.
Due to this superposition strong interference effects may occur.

\subsubsection*{Impedance}
An impedance is a complex ratio between two interdependent dynamic quantities
and describes the resistance to a direct flow (resistance) and alternating flow
(reactance). The specific acoustical impedance of a material is the ratio of the
sound pressure to the particle velocity normal to the surface $Z_{s} =
p/\vect{u}$. The specific acoustical impedance of a material or surface
normalised by the impedance of air $Z_{s, air} = \rho c$ is called the
normalised specific acoustic impedance. This impedance is typically used to
characterise surfaces, and is what impedance in the following text refers to.

Multiple models are available for the prediction of the impedance of a surface.
Attenborough et. al. made a comparison of impedance models and recommends the
Delany and Bazley one-parameter model for predicting outdoor ground impedance
\cite{Attenborough2011a}. The empirical one-parameter model by Delaney and
Bazley is widely used and depends on the flow resistivity of the material
$\sigma$ and the frequency $f$
\begin{equation}\label{eq:theory:sound:impedance:db}
 Z = 1 + 9.08 \left( \frac{1000f}{\sigma}\right)^{-0.75} - 11.9 j \left( \frac{1000f}{\sigma}\right)^{-0.73}
\end{equation}
Flow resistivity describes how difficult it is for air to flow through a
surface. Values for surfaces can vary significantly, with average values ranging
from \SI{29}{\kilo\pascal\second\per\square\meter} for snow to
\SI{200000}{\kilo\pascal\second\per\square\meter} for painted concrete. Grass
has an average flow resistivity of
\SI{200}{\kilo\pascal\second\per\square\meter} \cite{Crocker1997}.
Furthermore, a surface is called locally reacting if at a certain point the
particle velocity $\vect{u}$ depends only on the sound pressure $p$ at that
point. In case it doesn't the surface has an extended reaction.
Figure \ref{fig:theory:sound:impedance} shows the impedance of grass according to the Delaney and Bazley model.
\todo{drop or expand?}

\begin{figure}
        \centering
        \includegraphics[]{../figures/generated/sound/impedance}
        \caption{Impedance for grass with a flow resistivity of \SI{200}{\kilo\pascal\second\per\square\meter} according to Delany and Bazley one-parameter model.}
        \label{fig:theory:sound:impedance}
\end{figure}


%
% Another example of a model is the 2-parameter model by Attenborough. In this model, the impedance is given by
% \begin{equation}\label{eq:theory:sound:impedance:att}
%  Z = \frac{\left( 1-j\right) \sqrt{\sigma/f}}{\sqrt{\pi \gamma_0 \rho_0}} - \frac{jc\alpha}{8 \pi \gamma_0 f}
% \end{equation}
% and depends on the speed of sound in air $c_0$, the density of air $\rho_0$, $\alpha$, $\gamma_0$ and again the flow resistivity $\sigma$ and frequency $f$.

%
% Table \ref{tab:theory:sound:impedance:flow-resistivity} lists co
%
%
% \begin{tabular}{l c}
% Team              & P & W & D & L & F  & A & Pts \\
% \hline
% Manchester United & 6 & 4 & 0 & 2 & 10 & 5 & 12  \\
% Celtic            & 6 & 3 & 0 & 3 &  8 & 9 &  9  \\
% Benfica           & 6 & 2 & 1 & 3 &  7 & 8 &  7  \\
% FC Copenhagen     & 6 & 2 & 1 & 3 &  5 & 8 &  7  \\
% \end{tabular}


% \newpage
\subsubsection{Reflection coefficient}
The pressure reflection coefficient describes the ratio between the sound
pressure of an incident wave $p_i$ and the pressure of the reflected wave $p_r$
and considers a wave incident on an infinite plane that is locally
reacting and has impedance $Z$
\begin{equation}
  R = \frac{p_r}{p_i}
\end{equation}
The plane wave reflection coefficient gives the ratio of incident and reflected pressure assuming the incident wave is plane
\begin{equation}\label{eq:theory:sound:reflection:plane}
  R = \frac{Z\cos{\theta}-1}{Z\cos{\theta}+1}
\end{equation}
and is a function of the angle of incidence $\theta$ of the incident wave.
If the source is relatively close to the reflecting surface,
then typically the wave front is not plane. In such case a spherical wave
reflection factor is used that considers an incident spherical wave.

The impedance and reflection coefficient models together with their parameters
determine in computations how much sound is reflected and how much is
transmitted or absorbed. Because the reflection coefficient is complex-valued
the reflected contribution may have not only a different magnitude than the
direct contribution, but also an additional frequency-dependent phase shift or
propagation delay. Surfaces that attenuate and phase shift the reflected wave
are called acoustically soft surfaces. In case the normalised impedance
approaches infinity, neither attenuation nor phase shift occur, and the surface
is considered acoustically hard. Figure \ref{fig:theory:sound:reflection} shows
both the absolute value and the phase angle of the plane wave reflection angle
as function of frequency and angle of incidence.


% Another commonly used reflection coefficient is the spherical wave reflection coefficient.

% The spherical reflection coefficient is given by
% \begin{equation}\label{eq:theory:sound:reflection:spherical}
%  Q = R \left(1 - R \right) F
% \end{equation}
% with
% \begin{equation}
%  F = 1 - j \sqrt{ \pi} w e^{-w^2} \mathrm{erfc} \left( j w \right)
% \end{equation}
% and
% \begin{equation}
%  w = \sqrt{-j k r  \left( 1 + \frac{1}{Z} \cos{\theta} - \sqrt{1 - \left( \frac{1}{Z} \right)^2} \sin{\theta} \right) }
% \end{equation}

\begin{figure}
%     \centering
    \begin{subfigure}{\textwidth}
        \includegraphics{../figures/generated/sound/reflection-abs}
        \caption{Absolute value of the reflection coefficient.}
    \end{subfigure}
    ~
    \begin{subfigure}{\textwidth}
        \includegraphics{../figures/generated/sound/reflection-angle}
        \caption{Phase angle of the reflection coefficient.}
    \end{subfigure}
    \caption{Absolute value and phase angle of the plane wave reflection angle as function of both frequency and angle of incidence. The impedance was calculated using equation \ref{eq:theory:sound:impedance:db} and for the flow resistivity the average value for grass was chosen.}
    \label{fig:theory:sound:reflection}
\end{figure}

\subsubsection{Ground effect}
In outdoor situations the ground is typically providing the second-largest
contribution and is important when considering an elevated source. As mentioned
before, impedances of surfaces can vary significantly, and this is especially
the case for the ground surface. Spectrograms of recordings of aircraft often
show a distinct interference pattern called the Lloyd's mirror effect. Figure
\ref{fig:theory:sound:reflection:ground} shows a (synthesised) example of the
Lloyd's mirror effect as caused by an elevated moving source.

\begin{figure}
%     \centering
    \begin{subfigure}{\textwidth}
        \includegraphics{../figures/generated/sound-mirror-effect/hard}
        \caption{Hard surface.}
    \end{subfigure}
    ~
    \begin{subfigure}{\textwidth}
        \includegraphics{../figures/generated/sound-mirror-effect/soft}
        \caption{Soft surface.}
    \end{subfigure}
    \caption{Superposition of the direct contribution and ground-reflected contribution results in an interference pattern known as the Lloyd's mirror effect.}
    \label{fig:theory:sound:reflection:ground}
\end{figure}
\todo{interference pattern is shifted}

% A prominent reflection is the reflection with the ground. When the
% reflecting surface is sufficiently hard the Lloyd's
% mirror effect can be heard.


% \begin{figure}[H]
%         \centering
%         \includegraphics[width=0.9\textwidth]{../figures/ipynb/theory_reflections_mirror_effect/figure1}
%         \caption{Spectrogram of a white noise source flying at a height of 100 meters over an acoustically hard surface. The spectrogram clearly shows the Lloyd's mirorr effect.}
%         \label{fig:theory_reflections_mirror_effect}
% \end{figure}

% \missingfigure{SPL relative to free field comparison}


\subsubsection{Image source method}
\todo{while implemented I don't consider multiple reflections}

\missingfigure{Illustration of ISM}




\subsection{Descriptors}






